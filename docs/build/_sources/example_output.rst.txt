Output Files
===============

DRAM2 outputs various files in each module.

Let's breakdown the DRAM2 output for each module based on this example command:

    .. code-block:: bash

        nextflow run DRAM2.nf --rename --call --annotate --use_kegg --distill_topic <distillate(s)>

------------------

Call Output
------------

DRAM2 ``--call`` will output the following for each input FASTA file:

1. ``Prodigal_v2.6.3/<sample_name>_called_genes.<faa, fna, gff>``
2. ``Processed_inputs/<sample_name>_renamed.fna``
3. ``QUAST_v5.2.0/collected_quast.tsv`` and ``QUAST_v5.2.0/quast_results/``
4. ``tRNA_rRNA/collected_rrnas.tsv`` and ``tRNA_rRNA/collected_trnas.tsv`` 

------------------

Annotation Output
------------------

1. ``RAW/raw-annotations.tsv``

In the example below we have the KEGG database information included. If other databases we used, for example ``--use_db dbcan``, then additional columns after the KEGG information would be included for the dbCAN annotations.

Format:

    .. raw:: html

        <div style="overflow-x:auto;">

    .. csv-table:: 
        :header: "query_id", "sample", "start_position", "stop_position", "strandedness", "rank", "gene_number", "kegg_id", "kegg_EC", "kegg_bitScore", "kegg_description", "kegg_gene_name", "Completeness", "Contamination", "taxonomy"
        :widths: 10, 10, 15, 15, 10, 5, 10, 10, 10, 15, 20, 15, 10, 10, 20
        :align: center
        :delim: |

        query_1|sample1|100|200|+1|A|3|K12345|EC1.2.3|200.5|Description 1|Gene1|90%|2%|Bacteria;Firmicutes
        query_2|sample1|300|400|-1|C|5|K23456|EC2.3.4|180.3|Description 2|Gene2|85%|3%|Bacteria;Proteobacteria
        query_1|sample2|150|250|+1|A|6|K34567|EC3.4.5|210.7|Description 3|Gene3|92%|1%|Bacteria;Actinobacteria
        query_2|sample2|500|600|-1|E|8|K45678|EC4.5.6|195.2|Description 4|Gene4|88%|2%|Bacteria;Bacteroidetes

    .. raw:: html

------------------

Distill Output
---------------

Output file: ``DISTILL/distillate.xlsx``

DRAM2 distill output has 3 types of sheets within the output ``distillate.xlsx`` (XLSX) file:

**1. Genome_Stats** 

This sheet is generated by default and is populated based on the DRAM2 run performed.

Genome_Stats output sheet format:


    .. raw:: html

        <div style="overflow-x:auto;">

    .. csv-table:: 
        :header: "sample", "taxonomy", "Completeness", "Contamination", "tRNA count", "rRNA", "assembly length", "no. contigs", "largest contig", "N50", "GC (%)", "no. pred. genes"
        :align: center
        :delim: |

        sample1|Bacteria;Firmicutes|90%|2%|500|5|1000000|100|10000|5000|50%|5000
        sample2|Bacteria;Proteobacteria|85%|3%|600|6|1200000|120|12000|6000|55%|6000

    .. raw:: html

        </div>

------------------

**2. Distill Topic, Ecosystem and Custom output sheet format:**

DRAM2 will output a separate sheet for each Topic, Ecosystem and Custom provided. 

Each output sheet will contain the annotations found within the ``raw-annotations.tsv`` followed by and metadata and lastly, the count of each annotation in the ``raw-annotaions.tsv``.

    .. raw:: html

        <div style="overflow-x:auto;">

    .. csv-table::
        :header: "gene_id", "gene_description", "pathway", "topic_ecosystem", "category", "subcategory", "potential_amg", "sample1", "sample2"
        :align: center
        :delim: |

        K01647|citrate synthase [EC:2.3.3.1] [RN:R00351]|Citrate cycle (TCA cycle, Krebs cycle)|carbon utilization|central carbon|TCA|TRUE|1|0
        K05942|citrate (Re)-synthase [EC:2.3.3.3] [RN:R00351]|Citrate cycle (TCA cycle, Krebs cycle)|carbon utilization|central carbon|TCA|TRUE|3|6

    .. raw:: html

        </div>

------------------

**3. tRNA and rRNA output sheets**

rRNA and tRNA output sheets are only included if ``--call`` was used or if the user provided the input files required: ``--trnas <path/to/directory/*.tsv>`` and ``--rrnas <path/to/directory/*.tsv>``.

rRNA output sheet format:

    .. raw:: html

        <div style="overflow-x:auto;">

    .. csv-table:: 
        :header: "gene_id", "gene_description", "category", "topic_ecosystem", "subcategory", "sample1", "sample2"
        :align: center
        :delim: |

        5S rRNA|5S rRNA gene|rRNA|||0|1
        23S rRNA|23S rRNA gene|rRNA|||1|0
        16S rRNA|16S rRNA gene|rRNA|||0|1

    .. raw:: html

        </div>


tRNA output sheet format:

    .. raw:: html

        <div style="overflow-x:auto;">

    .. csv-table:: 
        :header: "gene_id", "gene_description", "category", "topic_ecosystem", "subcategory", "sample1", "sample2"
        :align: center
        :delim: |

        Ala (CGC)|Ala tRNA with Codon|Ala tRNA|tRNA||1|1
        His (GTG)|His tRNA with Codon|His tRNA|tRNA||0|1

    .. raw:: html

        </div>